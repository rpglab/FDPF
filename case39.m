%% IEEE 39-bus test case (New England system)
%   This case is modified from the Matpower case39.m file.
%
%   The original data are from the following reference:
%     G. W. Bills, et.al., "On-Line Stability Analysis Study" RP90-1 Report 
%     for the Edison Electric Institute, October 12, 1970, pp. 1-20 - 1-35. 
%     prepared by
%         E. M. Gulachenski - New England Electric System
%         J. M. Undrill - General Electric Co.
%     Comments:
%         "...generally representative of the New England 345 KV system, 
%          but is not an exact or complete model of any past, present or 
%          projected configuration of the actual New England 345 KV system"

%% bus data format
% 1.bus number  2.bus type  3.G_at_bus (G=0)  4.B_at_bus (B=0) 
% 5.Vm 6.angle (in degree)
% for bus type: 1 denotes PQ bus; 2 denotes PV bus; 3 denotes slack bus
bus = [
1	1	0	0	1.0393836	-13.536602
2	1	0	0	1.0484941	-9.7852666
3	1	0	0	1.0307077	-12.276384
4	1	0	0	1.00446	-12.626734
5	1	0	0	1.0060063	-11.192339
6	1	0	0	1.0082256	-10.40833
7	1	0	0	0.99839728	-12.755626
8	1	0	0	0.99787232	-13.335844
9	1	0	0	1.038332	-14.178442
10	1	0	0	1.0178431	-8.170875
11	1	0	0	1.0133858	-8.9369663
12	1	0	0	1.000815	-8.9988236
13	1	0	0	1.014923	-8.9299272
14	1	0	0	1.012319	-10.715295
15	1	0	0	1.0161854	-11.345399
16	1	0	0	1.0325203	-10.033348
17	1	0	0	1.0342365	-11.116436
18	1	0	0	1.0315726	-11.986168
19	1	0	0	1.0501068	-5.4100729
20	1	0	0	0.99101054	-6.8211783
21	1	0	0	1.0323192	-7.6287461
22	1	0	0	1.0501427	-3.1831199
23	1	0	0	1.0451451	-3.3812763
24	1	0	0	1.038001	-9.9137585
25	1	0	0	1.0576827	-8.3692354
26	1	0	0	1.0525613	-9.4387696
27	1	0	0	1.0383449	-11.362152
28	1	0	0	1.0503737	-5.9283592
29	1	0	0	1.0501149	-3.1698741
30	2	0	0	1.0499	-7.3704746
31	3	0	0	0.982	0
32	2	0	0	0.9841	-0.1884374
33	2	0	0	0.9972	-0.19317445
34	2	0	0	1.0123	-1.631119
35	2	0	0	1.0494	1.7765069
36	2	0	0	1.0636	4.4684374
37	2	0	0	1.0275	-1.5828988
38	2	0	0	1.0265	3.8928177
39	2	0	0	1.03	-14.535256
];
bus(:,3) = bus(:,3) / 100;
bus(:,4) = bus(:,4) / 100;

%% branch data format (may include transformer data here)
%  1.fromBusNum   2.toBusNum    3.R      4.X  
%  5.G/2 (=0)  6. (B/2)  7.tap=1
branch = [
1	2	0.0035	0.0411	0	0.34935	0
1	39	0.001	0.025	0	0.375	0
2	3	0.0013	0.0151	0	0.1286	0
2	25	0.007	0.0086	0	0.073	0
2	30	0	0.0181	0	0	1.025
3	4	0.0013	0.0213	0	0.1107	0
3	18	0.0011	0.0133	0	0.1069	0
4	5	0.0008	0.0128	0	0.0671	0
4	14	0.0008	0.0129	0	0.0691	0
5	6	0.0002	0.0026	0	0.0217	0
5	8	0.0008	0.0112	0	0.0738	0
6	7	0.0006	0.0092	0	0.0565	0
6	11	0.0007	0.0082	0	0.06945	0
6	31	0	0.025	0	0	1.07
7	8	0.0004	0.0046	0	0.039	0
8	9	0.0023	0.0363	0	0.1902	0
9	39	0.001	0.025	0	0.6	0
10	11	0.0004	0.0043	0	0.03645	0
10	13	0.0004	0.0043	0	0.03645	0
10	32	0	0.02	0	0	1.07
12	11	0.0016	0.0435	0	0	1.006
12	13	0.0016	0.0435	0	0	1.006
13	14	0.0009	0.0101	0	0.08615	0
14	15	0.0018	0.0217	0	0.183	0
15	16	0.0009	0.0094	0	0.0855	0
16	17	0.0007	0.0089	0	0.0671	0
16	19	0.0016	0.0195	0	0.152	0
16	21	0.0008	0.0135	0	0.1274	0
16	24	0.0003	0.0059	0	0.034	0
17	18	0.0007	0.0082	0	0.06595	0
17	27	0.0013	0.0173	0	0.1608	0
19	20	0.0007	0.0138	0	0	1.06
19	33	0.0007	0.0142	0	0	1.07
20	34	0.0009	0.018	0	0	1.009
21	22	0.0008	0.014	0	0.12825	0
22	23	0.0006	0.0096	0	0.0923	0
22	35	0	0.0143	0	0	1.025
23	24	0.0022	0.035	0	0.1805	0
23	36	0.0005	0.0272	0	0	1
25	26	0.0032	0.0323	0	0.2655	0
25	37	0.0006	0.0232	0	0	1.025
26	27	0.0014	0.0147	0	0.1198	0
26	28	0.0043	0.0474	0	0.3901	0
26	29	0.0057	0.0625	0	0.5145	0
28	29	0.0014	0.0151	0	0.1245	0
29	38	0.0008	0.0156	0	0	1.025
];
idxBrc = find(branch(:,7) == 0);
branch(idxBrc,7) = 1;

%% transformer data format
% 1.fromBusNum   2.toBusNum  3.RT  4.XT
% 5.GT  6.BT  7.tap

%% gen data format
% 1.genBusNum 2.active output 3.reactive output
gen = [ 
30	250	161.762
31	677.871	221.574
32	650	206.965
33	632	108.293
34	508	166.688
35	650	210.661
36	560	100.165
37	540	-1.36945
38	830	21.7327
39	1000	78.4674
];
gen(:,2) = gen(:,2) / 100;
gen(:,3) = gen(:,3) / 100;

%% load data format
% 1.busNum 2.active power load 3.reactive power load
load = [
1	97.6	44.2
2	0	0
3	322	2.4
4	500	184
5	0	0
6	0	0
7	233.8	84
8	522	176.6
9	6.5	-66.6
10	0	0
11	0	0
12	8.53	88
13	0	0
14	0	0
15	320	153
16	329	32.3
17	0	0
18	158	30
19	0	0
20	680	103
21	274	115
22	0	0
23	247.5	84.6
24	308.6	-92.2
25	224	47.2
26	139	17
27	281	75.5
28	206	27.6
29	283.5	26.9
30	0	0
31	9.2	4.6
32	0	0
33	0	0
34	0	0
35	0	0
36	0	0
37	0	0
38	0	0
39	1104	250
];
load(:,2) = load(:,2) / 100;
load(:,3) = load(:,3) / 100;

%% shunt data format if any
% 1.busNum  2.G  3.B





