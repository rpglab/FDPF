%% IEEE 118-bus test case
%   This case is modified from the Matpower case118.m file.
%
%   The original data of this test case are from the link below (in IEEE Common Data Format (ieee118cdf.txt)): 
%       https://labs.ece.uw.edu/pstca/pf118/ieee118cdf.txt

%% bus data format
% 1.bus number  2.bus type  3.G_at_bus (G=0)  4.B_at_bus (B=0) 
% 5.Vm 6.angle (in degree)
% for bus type: 1 denotes PQ bus; 2 denotes PV bus; 3 denotes slack bus
bus = [
1	2	0	0	0.955	10.67
2	1	0	0	0.971	11.22
3	1	0	0	0.968	11.56
4	2	0	0	0.998	15.28
5	1	0	-40	1.002	15.73
6	2	0	0	0.99	13
7	1	0	0	0.989	12.56
8	2	0	0	1.015	20.77
9	1	0	0	1.043	28.02
10	2	0	0	1.05	35.61
11	1	0	0	0.985	12.72
12	2	0	0	0.99	12.2
13	1	0	0	0.968	11.35
14	1	0	0	0.984	11.5
15	2	0	0	0.97	11.23
16	1	0	0	0.984	11.91
17	1	0	0	0.995	13.74
18	2	0	0	0.973	11.53
19	2	0	0	0.963	11.05
20	1	0	0	0.958	11.93
21	1	0	0	0.959	13.52
22	1	0	0	0.97	16.08
23	1	0	0	1	21
24	2	0	0	0.992	20.89
25	2	0	0	1.05	27.93
26	2	0	0	1.015	29.71
27	2	0	0	0.968	15.35
28	1	0	0	0.962	13.62
29	1	0	0	0.963	12.63
30	1	0	0	0.968	18.79
31	2	0	0	0.967	12.75
32	2	0	0	0.964	14.8
33	1	0	0	0.972	10.63
34	2	0	14	0.986	11.3
35	1	0	0	0.981	10.87
36	2	0	0	0.98	10.87
37	1	0	-25	0.992	11.77
38	1	0	0	0.962	16.91
39	1	0	0	0.97	8.41
40	2	0	0	0.97	7.35
41	1	0	0	0.967	6.92
42	2	0	0	0.985	8.53
43	1	0	0	0.978	11.28
44	1	0	10	0.985	13.82
45	1	0	10	0.987	15.67
46	2	0	10	1.005	18.49
47	1	0	0	1.017	20.73
48	1	0	15	1.021	19.93
49	2	0	0	1.025	20.94
50	1	0	0	1.001	18.9
51	1	0	0	0.967	16.28
52	1	0	0	0.957	15.32
53	1	0	0	0.946	14.35
54	2	0	0	0.955	15.26
55	2	0	0	0.952	14.97
56	2	0	0	0.954	15.16
57	1	0	0	0.971	16.36
58	1	0	0	0.959	15.51
59	2	0	0	0.985	19.37
60	1	0	0	0.993	23.15
61	2	0	0	0.995	24.04
62	2	0	0	0.998	23.43
63	1	0	0	0.969	22.75
64	1	0	0	0.984	24.52
65	2	0	0	1.005	27.65
66	2	0	0	1.05	27.48
67	1	0	0	1.02	24.84
68	1	0	0	1.003	27.55
69	3	0	0	1.035	30
70	2	0	0	0.984	22.58
71	1	0	0	0.987	22.15
72	2	0	0	0.98	20.98
73	2	0	0	0.991	21.94
74	2	0	12	0.958	21.64
75	1	0	0	0.967	22.91
76	2	0	0	0.943	21.77
77	2	0	0	1.006	26.72
78	1	0	0	1.003	26.42
79	1	0	20	1.009	26.72
80	2	0	0	1.04	28.96
81	1	0	0	0.997	28.1
82	1	0	20	0.989	27.24
83	1	0	10	0.985	28.42
84	1	0	0	0.98	30.95
85	2	0	0	0.985	32.51
86	1	0	0	0.987	31.14
87	2	0	0	1.015	31.4
88	1	0	0	0.987	35.64
89	2	0	0	1.005	39.69
90	2	0	0	0.985	33.29
91	2	0	0	0.98	33.31
92	2	0	0	0.993	33.8
93	1	0	0	0.987	30.79
94	1	0	0	0.991	28.64
95	1	0	0	0.981	27.67
96	1	0	0	0.993	27.51
97	1	0	0	1.011	27.88
98	1	0	0	1.024	27.4
99	2	0	0	1.01	27.04
100	2	0	0	1.017	28.03
101	1	0	0	0.993	29.61
102	1	0	0	0.991	32.3
103	2	0	0	1.001	24.44
104	2	0	0	0.971	21.69
105	2	0	20	0.965	20.57
106	1	0	0	0.962	20.32
107	2	0	6	0.952	17.53
108	1	0	0	0.967	19.38
109	1	0	0	0.967	18.93
110	2	0	6	0.973	18.09
111	2	0	0	0.98	19.74
112	2	0	0	0.975	14.99
113	2	0	0	0.993	13.74
114	1	0	0	0.96	14.46
115	1	0	0	0.96	14.46
116	2	0	0	1.005	27.12
117	1	0	0	0.974	10.67
118	1	0	0	0.949	21.92
];
bus(:,3) = bus(:,3) / 100;
bus(:,4) = bus(:,4) / 100;

%% branch data format (may include transformer data here)
%  1.fromBusNum   2.toBusNum    3.R      4.X  
%  5.G/2 (=0)  6. (B/2)  7.tap=1
branch = [
1	2	0.0303	0.0999	0	0.0127	0
1	3	0.0129	0.0424	0	0.00541	0
4	5	0.00176	0.00798	0	0.00105	0
3	5	0.0241	0.108	0	0.0142	0
5	6	0.0119	0.054	0	0.00713	0
6	7	0.00459	0.0208	0	0.00275	0
8	9	0.00244	0.0305	0	0.581	0
8	5	0	0.0267	0	0	0.985
9	10	0.00258	0.0322	0	0.615	0
4	11	0.0209	0.0688	0	0.00874	0
5	11	0.0203	0.0682	0	0.00869	0
11	12	0.00595	0.0196	0	0.00251	0
2	12	0.0187	0.0616	0	0.00786	0
3	12	0.0484	0.16	0	0.0203	0
7	12	0.00862	0.034	0	0.00437	0
11	13	0.02225	0.0731	0	0.00938	0
12	14	0.0215	0.0707	0	0.00908	0
13	15	0.0744	0.2444	0	0.03134	0
14	15	0.0595	0.195	0	0.0251	0
12	16	0.0212	0.0834	0	0.0107	0
15	17	0.0132	0.0437	0	0.0222	0
16	17	0.0454	0.1801	0	0.0233	0
17	18	0.0123	0.0505	0	0.00649	0
18	19	0.01119	0.0493	0	0.00571	0
19	20	0.0252	0.117	0	0.0149	0
15	19	0.012	0.0394	0	0.00505	0
20	21	0.0183	0.0849	0	0.0108	0
21	22	0.0209	0.097	0	0.0123	0
22	23	0.0342	0.159	0	0.0202	0
23	24	0.0135	0.0492	0	0.0249	0
23	25	0.0156	0.08	0	0.0432	0
26	25	0	0.0382	0	0	0.96
25	27	0.0318	0.163	0	0.0882	0
27	28	0.01913	0.0855	0	0.0108	0
28	29	0.0237	0.0943	0	0.0119	0
30	17	0	0.0388	0	0	0.96
8	30	0.00431	0.0504	0	0.257	0
26	30	0.00799	0.086	0	0.454	0
17	31	0.0474	0.1563	0	0.01995	0
29	31	0.0108	0.0331	0	0.00415	0
23	32	0.0317	0.1153	0	0.05865	0
31	32	0.0298	0.0985	0	0.01255	0
27	32	0.0229	0.0755	0	0.00963	0
15	33	0.038	0.1244	0	0.01597	0
19	34	0.0752	0.247	0	0.0316	0
35	36	0.00224	0.0102	0	0.00134	0
35	37	0.011	0.0497	0	0.00659	0
33	37	0.0415	0.142	0	0.0183	0
34	36	0.00871	0.0268	0	0.00284	0
34	37	0.00256	0.0094	0	0.00492	0
38	37	0	0.0375	0	0	0.935
37	39	0.0321	0.106	0	0.0135	0
37	40	0.0593	0.168	0	0.021	0
30	38	0.00464	0.054	0	0.211	0
39	40	0.0184	0.0605	0	0.00776	0
40	41	0.0145	0.0487	0	0.00611	0
40	42	0.0555	0.183	0	0.0233	0
41	42	0.041	0.135	0	0.0172	0
43	44	0.0608	0.2454	0	0.03034	0
34	43	0.0413	0.1681	0	0.02113	0
44	45	0.0224	0.0901	0	0.0112	0
45	46	0.04	0.1356	0	0.0166	0
46	47	0.038	0.127	0	0.0158	0
46	48	0.0601	0.189	0	0.0236	0
47	49	0.0191	0.0625	0	0.00802	0
42	49	0.0715	0.323	0	0.043	0
42	49	0.0715	0.323	0	0.043	0
45	49	0.0684	0.186	0	0.0222	0
48	49	0.0179	0.0505	0	0.00629	0
49	50	0.0267	0.0752	0	0.00937	0
49	51	0.0486	0.137	0	0.0171	0
51	52	0.0203	0.0588	0	0.00698	0
52	53	0.0405	0.1635	0	0.02029	0
53	54	0.0263	0.122	0	0.0155	0
49	54	0.073	0.289	0	0.0369	0
49	54	0.0869	0.291	0	0.0365	0
54	55	0.0169	0.0707	0	0.0101	0
54	56	0.00275	0.00955	0	0.00366	0
55	56	0.00488	0.0151	0	0.00187	0
56	57	0.0343	0.0966	0	0.0121	0
50	57	0.0474	0.134	0	0.0166	0
56	58	0.0343	0.0966	0	0.0121	0
51	58	0.0255	0.0719	0	0.00894	0
54	59	0.0503	0.2293	0	0.0299	0
56	59	0.0825	0.251	0	0.02845	0
56	59	0.0803	0.239	0	0.0268	0
55	59	0.04739	0.2158	0	0.02823	0
59	60	0.0317	0.145	0	0.0188	0
59	61	0.0328	0.15	0	0.0194	0
60	61	0.00264	0.0135	0	0.00728	0
60	62	0.0123	0.0561	0	0.00734	0
61	62	0.00824	0.0376	0	0.0049	0
63	59	0	0.0386	0	0	0.96
63	64	0.00172	0.02	0	0.108	0
64	61	0	0.0268	0	0	0.985
38	65	0.00901	0.0986	0	0.523	0
64	65	0.00269	0.0302	0	0.19	0
49	66	0.018	0.0919	0	0.0124	0
49	66	0.018	0.0919	0	0.0124	0
62	66	0.0482	0.218	0	0.0289	0
62	67	0.0258	0.117	0	0.0155	0
65	66	0	0.037	0	0	0.935
66	67	0.0224	0.1015	0	0.01341	0
65	68	0.00138	0.016	0	0.319	0
47	69	0.0844	0.2778	0	0.03546	0
49	69	0.0985	0.324	0	0.0414	0
68	69	0	0.037	0	0	0.935
69	70	0.03	0.127	0	0.061	0
24	70	0.00221	0.4115	0	0.05099	0
70	71	0.00882	0.0355	0	0.00439	0
24	72	0.0488	0.196	0	0.0244	0
71	72	0.0446	0.18	0	0.02222	0
71	73	0.00866	0.0454	0	0.00589	0
70	74	0.0401	0.1323	0	0.01684	0
70	75	0.0428	0.141	0	0.018	0
69	75	0.0405	0.122	0	0.062	0
74	75	0.0123	0.0406	0	0.00517	0
76	77	0.0444	0.148	0	0.0184	0
69	77	0.0309	0.101	0	0.0519	0
75	77	0.0601	0.1999	0	0.02489	0
77	78	0.00376	0.0124	0	0.00632	0
78	79	0.00546	0.0244	0	0.00324	0
77	80	0.017	0.0485	0	0.0236	0
77	80	0.0294	0.105	0	0.0114	0
79	80	0.0156	0.0704	0	0.00935	0
68	81	0.00175	0.0202	0	0.404	0
81	80	0	0.037	0	0	0.935
77	82	0.0298	0.0853	0	0.04087	0
82	83	0.0112	0.03665	0	0.01898	0
83	84	0.0625	0.132	0	0.0129	0
83	85	0.043	0.148	0	0.0174	0
84	85	0.0302	0.0641	0	0.00617	0
85	86	0.035	0.123	0	0.0138	0
86	87	0.02828	0.2074	0	0.02225	0
85	88	0.02	0.102	0	0.0138	0
85	89	0.0239	0.173	0	0.0235	0
88	89	0.0139	0.0712	0	0.00967	0
89	90	0.0518	0.188	0	0.0264	0
89	90	0.0238	0.0997	0	0.053	0
90	91	0.0254	0.0836	0	0.0107	0
89	92	0.0099	0.0505	0	0.0274	0
89	92	0.0393	0.1581	0	0.0207	0
91	92	0.0387	0.1272	0	0.01634	0
92	93	0.0258	0.0848	0	0.0109	0
92	94	0.0481	0.158	0	0.0203	0
93	94	0.0223	0.0732	0	0.00938	0
94	95	0.0132	0.0434	0	0.00555	0
80	96	0.0356	0.182	0	0.0247	0
82	96	0.0162	0.053	0	0.0272	0
94	96	0.0269	0.0869	0	0.0115	0
80	97	0.0183	0.0934	0	0.0127	0
80	98	0.0238	0.108	0	0.0143	0
80	99	0.0454	0.206	0	0.0273	0
92	100	0.0648	0.295	0	0.0236	0
94	100	0.0178	0.058	0	0.0302	0
95	96	0.0171	0.0547	0	0.00737	0
96	97	0.0173	0.0885	0	0.012	0
98	100	0.0397	0.179	0	0.0238	0
99	100	0.018	0.0813	0	0.0108	0
100	101	0.0277	0.1262	0	0.0164	0
92	102	0.0123	0.0559	0	0.00732	0
101	102	0.0246	0.112	0	0.0147	0
100	103	0.016	0.0525	0	0.0268	0
100	104	0.0451	0.204	0	0.02705	0
103	104	0.0466	0.1584	0	0.02035	0
103	105	0.0535	0.1625	0	0.0204	0
100	106	0.0605	0.229	0	0.031	0
104	105	0.00994	0.0378	0	0.00493	0
105	106	0.014	0.0547	0	0.00717	0
105	107	0.053	0.183	0	0.0236	0
105	108	0.0261	0.0703	0	0.00922	0
106	107	0.053	0.183	0	0.0236	0
108	109	0.0105	0.0288	0	0.0038	0
103	110	0.03906	0.1813	0	0.02305	0
109	110	0.0278	0.0762	0	0.0101	0
110	111	0.022	0.0755	0	0.01	0
110	112	0.0247	0.064	0	0.031	0
17	113	0.00913	0.0301	0	0.00384	0
32	113	0.0615	0.203	0	0.0259	0
32	114	0.0135	0.0612	0	0.00814	0
27	115	0.0164	0.0741	0	0.00986	0
114	115	0.0023	0.0104	0	0.00138	0
68	116	0.00034	0.00405	0	0.082	0
12	117	0.0329	0.14	0	0.0179	0
75	118	0.0145	0.0481	0	0.00599	0
76	118	0.0164	0.0544	0	0.00678	0
];
idxBrc = find(branch(:,7) == 0);
branch(idxBrc,7) = 1;

%% transformer data format
% 1.fromBusNum   2.toBusNum  3.RT  4.XT
% 5.GT  6.BT  7.tap

%% gen data format
% 1.genBusNum 2.active output 3.reactive output
gen = [ 
1	0	0
4	0	0
6	0	0
8	0	0
10	450	0
12	85	0
15	0	0
18	0	0
19	0	0
24	0	0
25	220	0
26	314	0
27	0	0
31	7	0
32	0	0
34	0	0
36	0	0
40	0	0
42	0	0
46	19	0
49	204	0
54	48	0
55	0	0
56	0	0
59	155	0
61	160	0
62	0	0
65	391	0
66	392	0
69	516.4	0
70	0	0
72	0	0
73	0	0
74	0	0
76	0	0
77	0	0
80	477	0
85	0	0
87	4	0
89	607	0
90	0	0
91	0	0
92	0	0
99	0	0
100	252	0
103	40	0
104	0	0
105	0	0
107	0	0
110	0	0
111	36	0
112	0	0
113	0	0
116	0	0
];
gen(:,2) = gen(:,2) / 100;
gen(:,3) = gen(:,3) / 100;

%% load data format
% 1.busNum 2.active power load 3.reactive power load
load = [
1	51	27
2	20	9
3	39	10
4	39	12
5	0	0
6	52	22
7	19	2
8	28	0
9	0	0
10	0	0
11	70	23
12	47	10
13	34	16
14	14	1
15	90	30
16	25	10
17	11	3
18	60	34
19	45	25
20	18	3
21	14	8
22	10	5
23	7	3
24	13	0
25	0	0
26	0	0
27	71	13
28	17	7
29	24	4
30	0	0
31	43	27
32	59	23
33	23	9
34	59	26
35	33	9
36	31	17
37	0	0
38	0	0
39	27	11
40	66	23
41	37	10
42	96	23
43	18	7
44	16	8
45	53	22
46	28	10
47	34	0
48	20	11
49	87	30
50	17	4
51	17	8
52	18	5
53	23	11
54	113	32
55	63	22
56	84	18
57	12	3
58	12	3
59	277	113
60	78	3
61	0	0
62	77	14
63	0	0
64	0	0
65	0	0
66	39	18
67	28	7
68	0	0
69	0	0
70	66	20
71	0	0
72	12	0
73	6	0
74	68	27
75	47	11
76	68	36
77	61	28
78	71	26
79	39	32
80	130	26
81	0	0
82	54	27
83	20	10
84	11	7
85	24	15
86	21	10
87	0	0
88	48	10
89	0	0
90	163	42
91	10	0
92	65	10
93	12	7
94	30	16
95	42	31
96	38	15
97	15	9
98	34	8
99	42	0
100	37	18
101	22	15
102	5	3
103	23	16
104	38	25
105	31	26
106	43	16
107	50	12
108	2	1
109	8	3
110	39	30
111	0	0
112	68	13
113	6	0
114	8	3
115	22	7
116	184	0
117	20	8
118	33	15
];
load(:,2) = load(:,2) / 100;
load(:,3) = load(:,3) / 100;

%% shunt data format if any
% 1.busNum  2.G  3.B





