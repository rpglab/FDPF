%% This code is to verify the AC power flow results 
%    with the results obtained with Matpower

%                        total P loss (in MW)  |  total Q loss (in MVAr)
% This program                 132.48                    781.27
% Matpower (NR method)         132.86                    783.79

% The maximum absolute difference for voltage magnitude is:       0.009000000000000
% The maximum absolute difference for voltage angle (degree) is:  4.010014212599889e-04

% The average absolute difference for voltage magnitude is:       0.089530686712165
% The average absolute difference for voltage angle (degree) is:  0.009013478389529

% Data format
% 1.bus number  2.Vm 3.ang in degree  
results_Matpower = [
1	0.955	10.973
2	0.971	11.513
3	0.968	11.856
4	0.998	15.574
5	1.002	16.019
6	0.99	13.292
7	0.989	12.847
8	1.015	21.041
9	1.043	28.295
10	1.05	35.876
11	0.985	13.006
12	0.99	12.489
13	0.968	11.63
14	0.984	11.771
15	0.97	11.474
16	0.984	12.187
17	0.995	13.995
18	0.973	11.781
19	0.962	11.315
20	0.957	12.191
21	0.958	13.778
22	0.969	16.332
23	0.999	21.249
24	0.992	21.114
25	1.05	28.18
26	1.015	29.96
27	0.968	15.604
28	0.962	13.879
29	0.963	12.885
30	0.985	19.034
31	0.967	13.002
32	0.963	15.061
33	0.971	10.854
34	0.984	11.511
35	0.98	11.055
36	0.98	11.056
37	0.991	11.967
38	0.961	17.108
39	0.97	8.577
40	0.97	7.496
41	0.967	7.052
42	0.985	8.653
43	0.977	11.46
44	0.984	13.943
45	0.986	15.773
46	1.005	18.576
47	1.017	20.799
48	1.021	20.019
49	1.025	21.022
50	1.001	18.983
51	0.967	16.364
52	0.957	15.411
53	0.946	14.436
54	0.955	15.348
55	0.952	15.058
56	0.954	15.245
57	0.971	16.449
58	0.959	15.592
59	0.985	19.448
60	0.993	23.23
61	0.995	24.121
62	0.998	23.505
63	0.969	22.827
64	0.984	24.593
65	1.005	27.719
66	1.05	27.559
67	1.02	24.919
68	1.003	27.598
69	1.035	30.000
70	0.984	22.618
71	0.987	22.207
72	0.98	21.109
73	0.991	21.995
74	0.958	21.669
75	0.967	22.93
76	0.943	21.799
77	1.006	26.751
78	1.003	26.447
79	1.009	26.745
80	1.04	28.99
81	0.997	28.145
82	0.989	27.272
83	0.984	28.464
84	0.98	31
85	0.985	32.556
86	0.987	31.186
87	1.015	31.445
88	0.987	35.69
89	1.005	39.748
90	0.985	33.338
91	0.98	33.351
92	0.99	33.881
93	0.985	30.849
94	0.99	28.682
95	0.98	27.71
96	0.992	27.543
97	1.011	27.916
98	1.024	27.433
99	1.01	27.067
100	1.017	28.059
101	0.991	29.647
102	0.989	32.365
103	1.01	24.318
104	0.971	21.748
105	0.965	20.644
106	0.961	20.383
107	0.952	17.583
108	0.966	19.443
109	0.967	18.991
110	0.973	18.144
111	0.98	19.789
112	0.975	15.045
113	0.993	13.993
114	0.96	14.726
115	0.96	14.718
116	1.005	27.163
117	0.974	10.948
118	0.949	21.942
];

Vm_verify = results_Matpower(:,2);
errorVm = abs(Vm_verify - Vm);
maxerrorVm = max(errorVm)
meanerrorVm = mean(errorVm)

ang_verify = results_Matpower(:,3);
errorang = abs(ang_verify - ang_degree);
maxerrorang = max(errorang)
meanerrorang = mean(errorang)





